CREATE TABLE TEMPORAL_PEDIDO(
	ID_PRODUCTO INT NOT NULL,
	NOMBRE VARCHAR2(50) NOT NULL,
	PRECIO FLOAT NOT NULL,
	PRECIO_TOTAL FLOAT NOT NULL,
	CANTIDAD NUMBER NOT NULL,
	TEMPORAL NUMBER NULL,
);

PROCEDURE AGREGAR_PEDIDO(ID_PRODUCTO NUMBER,NOMBRE VARCHAR2,PRECIO FLOAT,CANTIDAD NUMBER,TEMPORAL NUMBER)
        AS
        BEGIN   
            INSERT INTO TEMPORAL_PEDIDO(ID_PRODUCTO,NOMBRE,PRECIO,PRECIO_TOTAL, CANTIDAD,TEMPORAL NUMBER) VALUES (ID_PRODUCTO,NOMBRE,PRECIO,PRECIO*CANTIDAD, CANTIDAD,(SELECT SUM(PRECIO_TOTAL) FROM TEMPORAL_PEDIDO));
      END;

PROCEDURE AGREGAR_TABLA_PEDIDOS(ID_CLIENTE NUMBER,TOTAL FLOAT)
        AS
        BEGIN
	
            INSERT INTO PEDIDO (ID_CLIENTE,TOTAL,FECHA) VALUES (SELECT ID_CLIENTE FROM CLIENTES WHERE CEDULA = ID_CLIENTE, TOTAL,(SELECT to_char(SYSDATE,'dd/mm/yyyy')FROM DUAL));
      END;
      
TOTAL PARA LA TABLA PEDIDO**SELECT SUM((PRECIO*CANTIDAD)) FROM TEMPORAL_PEDIDO;

CREATE OR REPLACE FUNCTION TOTAL_CAJA (FECHA_HOY VARCHAR2)
RETURN FLOAT
IS 
CANTIDAD FLOAT;
BEGIN 
	
SELECT SUM(TOTAL) INTO CANTIDAD FROM PEDIDO WHERE FECHA=FECHA_HOY;
RETURN CANTIDAD;

END;


CREATE OR REPLACE TRIGGER TRIGGER_PEDIDO_TABLA
AFTER  INSERT ON TABLA_PEDIDOS
  FOR EACH ROW
     BEGIN
DECLARE
	BEGIN
       	 UPDATE TABLA_PEDIDOS SET FECHA = (SELECT to_char(SYSDATE,'dd/mm/yyyy')FROM DUAL), HORA = VHORA WHERE ID_PEDIDO = :NEW.ID_PEDIDO;
END;
